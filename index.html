
<!DOCTYPE html>
<html lang="ta">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ЁЯОЙ ро╡ро┐ро┤ро╛ рокрогродрпН родрпКроХрпБрокрпНрокрпБ - Event Fund Manager</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header Styles */
        .header {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            color: #333;
            margin-bottom: 10px;
            font-size: 2.5em;
        }

        .header p {
            color: #666;
            font-size: 1.1em;
        }

        /* Card Styles */
        .card {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            border: 1px solid #e0e0e0;
        }

        .card h2 {
            margin-bottom: 20px;
            color: #333;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 10px;
        }

        /* Form Styles */
        .form-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .form-input {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: #4CAF50;
            box-shadow: 0 0 0 2px rgba(76, 175, 80, 0.1);
        }

        /* Button Styles */
        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn-primary {
            background-color: #4CAF50;
            color: white;
        }

        .btn-primary:hover {
            background-color: #45a049;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background-color: #2196F3;
            color: white;
        }

        .btn-secondary:hover {
            background-color: #1976D2;
            transform: translateY(-2px);
        }

        .btn-danger {
            background-color: #e74c3c;
            color: white;
        }

        .btn-danger:hover {
            background-color: #c0392b;
            transform: translateY(-2px);
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            gap: 20px;
            border-left: 4px solid #4CAF50;
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-2px);
        }

        .stat-icon {
            font-size: 2.5em;
        }

        .stat-info h3 {
            margin: 0;
            font-size: 2em;
            color: #333;
        }

        .stat-info p {
            margin: 5px 0 0 0;
            color: #666;
            font-weight: 500;
        }

        /* Event Cards */
        .event-card {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            margin: 15px 0;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #4CAF50;
            transition: all 0.3s ease;
        }

        .event-card:hover {
            background: #e9ecef;
            transform: translateX(5px);
        }

        .event-info {
            flex-grow: 1;
        }

        .event-info h3 {
            margin: 0 0 10px 0;
            color: #333;
            font-size: 1.3em;
        }

        .event-info p {
            margin: 5px 0;
            color: #666;
        }

        /* Participant and Contribution Items */
        .participant-item, .contribution-item {
            padding: 15px;
            margin: 10px 0;
            background: white;
            border-radius: 8px;
            border-left: 3px solid #2196F3;
        }

        .contribution-item {
            border-left-color: #4CAF50;
        }

        .participant-name {
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }

        .participant-details {
            color: #666;
            font-size: 0.9em;
        }

        .contribution-details {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 5px;
        }

        .contribution-amount {
            font-weight: bold;
            color: #4CAF50;
            font-size: 1.1em;
        }

        .contribution-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: #666;
            font-size: 0.9em;
        }

        .payment-method {
            background: #e3f2fd;
            color: #1976d2;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.8em;
        }

        /* Progress Section */
        .progress-section {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background-color: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4CAF50, #8BC34A);
            transition: width 0.5s ease;
            border-radius: 10px;
        }

        .progress-text {
            text-align: center;
            font-weight: bold;
            margin-top: 10px;
            color: #333;
        }

        /* Empty States */
        .empty-state {
            text-align: center;
            padding: 40px;
            color: #666;
            font-style: italic;
            background: #f8f9fa;
            border-radius: 8px;
            border: 2px dashed #ddd;
        }

        /* Management Sections */
        .management-section {
            margin: 25px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .management-section h3 {
            margin-top: 0;
            color: #333;
            border-bottom: 1px solid #ddd;
            padding-bottom: 10px;
        }

        /* Tabs */
        .tabs {
            display: flex;
            margin-bottom: 20px;
            background: white;
            border-radius: 10px;
            padding: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .tab {
            padding: 12px 20px;
            cursor: pointer;
            border-radius: 5px;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .tab.active {
            background: #4CAF50;
            color: white;
        }

        .tab:hover:not(.active) {
            background: #f0f0f0;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .form-group {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .event-card {
                flex-direction: column;
                text-align: center;
                gap: 15px;
            }
            
            .contribution-details, .contribution-meta {
                flex-direction: column;
                align-items: flex-start;
                gap: 5px;
            }
            
            .container {
                padding: 10px;
            }
            
            .header {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2em;
            }
        }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .btn-small {
            padding: 8px 15px;
            font-size: 14px;
        }

        /* Success Messages */
        .success-message {
            background: #d4edda;
            color: #155724;
            padding: 12px;
            border-radius: 5px;
            margin: 10px 0;
            border: 1px solid #c3e6cb;
        }

        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 12px;
            border-radius: 5px;
            margin: 10px 0;
            border: 1px solid #f5c6cb;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>ЁЯОЙ ро╡ро┐ро┤ро╛ рокрогродрпН родрпКроХрпБрокрпНрокрпБ</h1>
            <p>роЙроЩрпНроХро│рпН ро╡ро┐ро┤ро╛ роиро┐родро┐роХро│рпИ роОро│ро┐родро╛роХ роиро┐ро░рпНро╡роХро┐роХрпНроХро╡рпБроорпН</p>
        </div>

        <!-- Tabs Navigation -->
        <div class="tabs">
            <div class="tab active" onclick="showTab('events')">ЁЯУЕ ро╡ро┐ро┤ро╛роХрпНроХро│рпН</div>
            <div class="tab" onclick="showTab('participants')">ЁЯСе рокроЩрпНроХрпЗро▒рпНрокро╛ро│ро░рпНроХро│рпН</div>
            <div class="tab" onclick="showTab('contributions')">ЁЯТ░ рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│рпН</div>
            <div class="tab" onclick="showTab('reports')">ЁЯУК роЕро▒ро┐роХрпНроХрпИроХро│рпН</div>
        </div>

        <!-- Stats Overview -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">ЁЯУК</div>
                <div class="stat-info">
                    <h3 id="totalEvents">0</h3>
                    <p>роорпКродрпНрод ро╡ро┐ро┤ро╛роХрпНроХро│рпН</p>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">ЁЯТ░</div>
                <div class="stat-info">
                    <h3 id="totalAmount">тВ╣0</h3>
                    <p>роорпКродрпНрод родрпКроХрпИ</p>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">ЁЯСе</div>
                <div class="stat-info">
                    <h3 id="totalParticipants">0</h3>
                    <p>роорпКродрпНрод рокроЩрпНроХрпЗро▒рпНрокро╛ро│ро░рпНроХро│рпН</p>
                </div>
            </div>
        </div>

        <!-- Events Tab -->
        <div id="events" class="tab-content active">
            <div class="card">
                <h2>ЁЯУЕ рокрпБродро┐роп ро╡ро┐ро┤ро╛ро╡рпИ роЙро░рпБро╡ро╛роХрпНроХро╡рпБроорпН</h2>
                <div class="form-group">
                    <input type="text" id="eventName" placeholder="ро╡ро┐ро┤ро╛ рокрпЖропро░рпН (роО.роХро╛: родро┐ро░рпБроорогроорпН)" class="form-input">
                    <input type="text" id="eventType" placeholder="ро╡ро┐ро┤ро╛ ро╡роХрпИ" class="form-input">
                    <input type="date" id="eventDate" class="form-input">
                    <input type="text" id="eventLocation" placeholder="роЗроЯроорпН" class="form-input">
                    <input type="number" id="eventTarget" placeholder="роЗро▓роХрпНроХрпБ родрпКроХрпИ" class="form-input">
                    <button onclick="createEvent()" class="btn btn-primary">ро╡ро┐ро┤ро╛ро╡рпИ роЙро░рпБро╡ро╛роХрпНроХро╡рпБроорпН</button>
                </div>
            </div>

            <div class="card">
                <h2>ЁЯУЛ роЙроЩрпНроХро│рпН ро╡ро┐ро┤ро╛роХрпНроХро│рпН</h2>
                <div id="eventsList">
                    <!-- Events will be displayed here -->
                </div>
            </div>
        </div>

        <!-- Participants Tab -->
        <div id="participants" class="tab-content">
            <div class="card">
                <h2>ЁЯСе рокроЩрпНроХрпЗро▒рпНрокро╛ро│ро░рпИроЪрпН роЪрпЗро░рпНроХрпНроХро╡рпБроорпН</h2>
                <div class="form-group">
                    <select id="participantEvent" class="form-input">
                        <option value="">ро╡ро┐ро┤ро╛ро╡рпИродрпН родрпЗро░рпНроирпНродрпЖроЯрпБроХрпНроХро╡рпБроорпН</option>
                    </select>
                    <input type="text" id="participantName" placeholder="роорпБро┤рпБ рокрпЖропро░рпН" class="form-input">
                    <input type="text" id="participantPhone" placeholder="родрпКро▓рпИрокрпЗроЪро┐ роОрогрпН" class="form-input">
                    <input type="email" id="participantEmail" placeholder="рооро┐ройрпНройроЮрпНроЪро▓рпН (ро╡ро┐ро░рпБрокрпНрокроорпН)" class="form-input">
                    <input type="text" id="participantPlace" placeholder="рокроЩрпНроХрпЗро▒рпНрокро╛ро│ро░ро┐ройрпН роЗроЯроорпН" class="form-input">
                    <button onclick="addParticipant()" class="btn btn-primary">рокроЩрпНроХрпЗро▒рпНрокро╛ро│ро░рпИроЪрпН роЪрпЗро░рпНроХрпНроХро╡рпБроорпН</button>
                </div>
            </div>

            <div class="card">
                <h2>рокроЩрпНроХрпЗро▒рпНрокро╛ро│ро░рпНроХро│рпН рокроЯрпНроЯро┐ропро▓рпН</h2>
                <div id="participantsList">
                    <!-- Participants will be displayed here -->
                </div>
            </div>
        </div>

        <!-- Contributions Tab -->
        <div id="contributions" class="tab-content">
            <div class="card">
                <h2>ЁЯТ╡ рокроЩрпНроХро│ро┐рокрпНрокрпИрокрпН рокродро┐ро╡рпБ роЪрпЖропрпНропро╡рпБроорпН</h2>
                <div class="form-group">
                    <select id="contributionEvent" class="form-input">
                        <option value="">ро╡ро┐ро┤ро╛ро╡рпИродрпН родрпЗро░рпНроирпНродрпЖроЯрпБроХрпНроХро╡рпБроорпН</option>
                    </select>
                    <select id="contributionParticipant" class="form-input">
                        <option value="">рокроЩрпНроХрпЗро▒рпНрокро╛ро│ро░рпИродрпН родрпЗро░рпНроирпНродрпЖроЯрпБроХрпНроХро╡рпБроорпН</option>
                    </select>
                    <input type="number" id="contributionAmount" placeholder="родрпКроХрпИ" class="form-input">
                    <select id="contributionMethod" class="form-input">
                        <option value="cash">ЁЯТ╡ ро░рпКроХрпНроХроорпН</option>
                        <option value="digital">ЁЯУ▒ роЯро┐роЬро┐роЯрпНроЯро▓рпН</option>
                        <option value="bank">ЁЯПж ро╡роЩрпНроХро┐</option>
                    </select>
                    <input type="text" id="contributionNotes" placeholder="роХрпБро▒ро┐рокрпНрокрпБроХро│рпН (ро╡ро┐ро░рпБрокрпНрокроорпН)" class="form-input">
                    <button onclick="addContribution()" class="btn btn-primary">рокроЩрпНроХро│ро┐рокрпНрокрпИрокрпН рокродро┐ро╡рпБ роЪрпЖропрпНропро╡рпБроорпН</button>
                </div>
            </div>

            <div class="card">
                <h2>роЪроорпАрокродрпНродро┐роп рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│рпН</h2>
                <div id="contributionsList">
                    <!-- Contributions will be displayed here -->
                </div>
            </div>
        </div>

        <!-- Reports Tab -->
        <div id="reports" class="tab-content">
            <div class="card">
                <h2>ЁЯУК роЕро▒ро┐роХрпНроХрпИроХро│рпН</h2>
                <div class="form-group">
                    <select id="reportEvent" class="form-input">
                        <option value="">роЕро▒ро┐роХрпНроХрпИроХрпНроХро╛рой ро╡ро┐ро┤ро╛ро╡рпИродрпН родрпЗро░рпНроирпНродрпЖроЯрпБроХрпНроХро╡рпБроорпН</option>
                    </select>
                    <button onclick="generateEventReport()" class="btn btn-primary">ЁЯУД ро╡ро┐ро┤ро╛ роЕро▒ро┐роХрпНроХрпИ</button>
                    <button onclick="generateParticipantList()" class="btn btn-secondary">ЁЯСе рокроЩрпНроХрпЗро▒рпНрокро╛ро│ро░рпН рокроЯрпНроЯро┐ропро▓рпН</button>
                    <button onclick="generateContributionReport()" class="btn btn-secondary">ЁЯТ░ рокроЩрпНроХро│ро┐рокрпНрокрпБ роЕро▒ро┐роХрпНроХрпИ</button>
                </div>
            </div>

            <div class="card">
                <h2>ро╡ро┐ро┤ро╛ роорпБройрпНройрпЗро▒рпНро▒роорпН</h2>
                <div id="eventProgress">
                    <!-- Progress will be displayed here -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // Data Storage
        let events = JSON.parse(localStorage.getItem('events')) || [];
        let participants = JSON.parse(localStorage.getItem('participants')) || [];
        let contributions = JSON.parse(localStorage.getItem('contributions')) || [];

        // Initialize the app
        function initApp() {
            updateStats();
            displayEvents();
            updateEventDropdowns();
            displayParticipants();
            displayContributions();
            updateProgress();
        }

        // Tab Navigation
        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to clicked tab
            event.target.classList.add('active');
        }

        // Event Management
        function createEvent() {
            const name = document.getElementById('eventName').value;
            const type = document.getElementById('eventType').value;
            const date = document.getElementById('eventDate').value;
            const location = document.getElementById('eventLocation').value;
            const targetAmount = parseFloat(document.getElementById('eventTarget').value);

            if (!name || !date || !targetAmount) {
                alert('родропро╡рпБ роЪрпЖропрпНродрпБ роЕройрпИродрпНродрпБ рокрпБро▓роЩрпНроХро│рпИропрпБроорпН роиро┐ро░рокрпНрокро╡рпБроорпН');
                return;
            }

            const event = {
                id: Date.now().toString(),
                name,
                type,
                date,
                location,
                targetAmount,
                createdAt: new Date().toISOString()
            };

            events.push(event);
            saveData();
            updateStats();
            displayEvents();
            updateEventDropdowns();
            
            // Clear form
            document.getElementById('eventName').value = '';
            document.getElementById('eventType').value = '';
            document.getElementById('eventDate').value = '';
            document.getElementById('eventLocation').value = '';
            document.getElementById('eventTarget').value = '';

            showSuccess('ро╡ро┐ро┤ро╛ ро╡рпЖро▒рпНро▒ро┐роХро░рооро╛роХ роЙро░рпБро╡ро╛роХрпНроХрокрпНрокроЯрпНроЯродрпБ!');
        }

        function displayEvents() {
            const eventsList = document.getElementById('eventsList');
            
            if (events.length === 0) {
                eventsList.innerHTML = '<div class="empty-state"><p>роЗройрпНройрпБроорпН ро╡ро┐ро┤ро╛роХрпНроХро│рпН роЙро░рпБро╡ро╛роХрпНроХрокрпНрокроЯро╡ро┐ро▓рпНро▓рпИ. роорпБродро▓рпН ро╡ро┐ро┤ро╛ро╡рпИ роорпЗро▓рпЗ роЙро░рпБро╡ро╛роХрпНроХро╡рпБроорпН!</p></div>';
                return;
            }

            eventsList.innerHTML = events.map(event => `
                <div class="event-card">
                    <div class="event-info">
                        <h3>${event.name}</h3>
                        <p><strong>ро╡роХрпИ:</strong> ${event.type}</p>
                        <p><strong>родрпЗродро┐:</strong> ${event.date}</p>
                        <p><strong>роЗроЯроорпН:</strong> ${event.location}</p>
                        <p><strong>роЗро▓роХрпНроХрпБ:</strong> тВ╣${event.targetAmount}</p>
                    </div>
                    <div class="action-buttons">
                        <button onclick="selectEvent('${event.id}')" class="btn btn-secondary btn-small">родрпЗро░рпНроирпНродрпЖроЯрпБ</button>
                        <button onclick="deleteEvent('${event.id}')" class="btn btn-danger btn-small">ЁЯЧСя╕П</button>
                    </div>
                </div>
            `).join('');
        }

        function deleteEvent(eventId) {
            if (confirm('роЗроирпНрод ро╡ро┐ро┤ро╛ро╡рпИ роиро┐роЪрпНроЪропрооро╛роХ роирпАроХрпНроХ ро╡рпЗрогрпНроЯрпБрооро╛?')) {
                events = events.filter(event => event.id !== eventId);
                participants = participants.filter(participant => participant.eventId !== eventId);
                contributions = contributions.filter(contribution => contribution.eventId !== eventId);
                saveData();
                updateStats();
                displayEvents();
                displayParticipants();
                displayContributions();
                updateEventDropdowns();
                showSuccess('ро╡ро┐ро┤ро╛ роирпАроХрпНроХрокрпНрокроЯрпНроЯродрпБ!');
            }
        }

        // Participant Management
        function addParticipant() {
            const eventId = document.getElementById('participantEvent').value;
            const name = document.getElementById('participantName').value;
            const phone = document.getElementById('participantPhone').value;
            const email = document.getElementById('participantEmail').value;
            const place = document.getElementById('participantPlace').value;

            if (!eventId || !name || !phone) {
                alert('рокроЩрпНроХрпЗро▒рпНрокро╛ро│ро░рпН рокрпЖропро░рпН, родрпКро▓рпИрокрпЗроЪро┐ роОрогрпН рооро▒рпНро▒рпБроорпН ро╡ро┐ро┤ро╛ро╡рпИродрпН родрпЗро░рпНроирпНродрпЖроЯрпБроХрпНроХро╡рпБроорпН');
                return;
            }

            const participant = {
                id: Date.now().toString(),
                eventId,
                name,
                phone,
                email,
                place,
                createdAt: new Date().toISOString()
            };

            participants.push(participant);
            saveData();
            updateStats();
            displayParticipants();
            updateParticipantDropdown();
            
            // Clear form
            document.getElementById('participantName').value = '';
            document.getElementById('participantPhone').value = '';
            document.getElementById('participantEmail').value = '';
            document.getElementById('participantPlace').value = '';

            showSuccess('рокроЩрпНроХрпЗро▒рпНрокро╛ро│ро░рпН ро╡рпЖро▒рпНро▒ро┐роХро░рооро╛роХ роЪрпЗро░рпНроХрпНроХрокрпНрокроЯрпНроЯродрпБ!');
        }

        function displayParticipants() {
            const participantsList = document.getElementById('participantsList');
            
            if (participants.length === 0) {
                participantsList.innerHTML = '<div class="empty-state"><p>роЗройрпНройрпБроорпН рокроЩрпНроХрпЗро▒рпНрокро╛ро│ро░рпНроХро│рпН роЪрпЗро░рпНроХрпНроХрокрпНрокроЯро╡ро┐ро▓рпНро▓рпИ</p></div>';
                return;
            }

            participantsList.innerHTML = participants.map(participant => {
                const event = events.find(e => e.id === participant.eventId);
                return `
                    <div class="participant-item">
                        <div class="participant-name">${participant.name}</div>
                        <div class="participant-details">
                            <span>ЁЯУЮ ${participant.phone}</span>
                            ${participant.email ? ` | ЁЯУз ${participant.email}` : ''}
                            ${participant.place ? ` | ЁЯУН ${participant.place}` : ''}
                            ${event ? ` | ЁЯОЙ ${event.name}` : ''}
                        </div>
                        <div class="action-buttons">
                            <button onclick="deleteParticipant('${participant.id}')" class="btn btn-danger btn-small">ЁЯЧСя╕П</button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function deleteParticipant(participantId) {
            if (confirm('роЗроирпНрод рокроЩрпНроХрпЗро▒рпНрокро╛ро│ро░рпИ роиро┐роЪрпНроЪропрооро╛роХ роирпАроХрпНроХ ро╡рпЗрогрпНроЯрпБрооро╛?')) {
                participants = participants.filter(participant => participant.id !== participantId);
                contributions = contributions.filter(contribution => contribution.participantId !== participantId);
                saveData();
                updateStats();
                displayParticipants();
                displayContributions();
                updateParticipantDropdown();
                showSuccess('рокроЩрпНроХрпЗро▒рпНрокро╛ро│ро░рпН роирпАроХрпНроХрокрпНрокроЯрпНроЯродрпБ!');
            }
        }

        // Contribution Management
        function addContribution() {
            const eventId = document.getElementById('contributionEvent').value;
            const participantId = document.getElementById('contributionParticipant').value;
            const amount = parseFloat(document.getElementById('contributionAmount').value);
            const paymentMethod = document.getElementById('contributionMethod').value;
            const notes = document.getElementById('contributionNotes').value;

            if (!eventId || !participantId || !amount) {
                alert('ро╡ро┐ро┤ро╛, рокроЩрпНроХрпЗро▒рпНрокро╛ро│ро░рпН рооро▒рпНро▒рпБроорпН родрпКроХрпИропрпИродрпН родрпЗро░рпНроирпНродрпЖроЯрпБроХрпНроХро╡рпБроорпН');
                return;
            }

            const participant = participants.find(p => p.id === participantId);
            const contribution = {
                id: Date.now().toString(),
                eventId,
                participantId,
                participantName: participant.name,
                participantPhone: participant.phone,
                amount,
                paymentMethod,
                notes,
                date: new Date().toISOString()
            };

            contributions.push(contribution);
            saveData();
            updateStats();
            displayContributions();
            updateProgress();
            
            // Clear form
            document.getElementById('contributionAmount').value = '';
            document.getElementById('contributionNotes').value = '';

            showSuccess('рокроЩрпНроХро│ро┐рокрпНрокрпБ ро╡рпЖро▒рпНро▒ро┐роХро░рооро╛роХ рокродро┐ро╡рпБ роЪрпЖропрпНропрокрпНрокроЯрпНроЯродрпБ!');
        }

        function displayContributions() {
            const contributionsList = document.getElementById('contributionsList');
            
            if (contributions.length === 0) {
                contributionsList.innerHTML = '<div class="empty-state"><p>роЗройрпНройрпБроорпН рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│рпН рокродро┐ро╡рпБ роЪрпЖропрпНропрокрпНрокроЯро╡ро┐ро▓рпНро▓рпИ</p></div>';
                return;
            }

            contributionsList.innerHTML = contributions.map(contribution => {
                const event = events.find(e => e.id === contribution.eventId);
                const paymentMethodText = {
                    'cash': 'ро░рпКроХрпНроХроорпН',
                    'digital': 'роЯро┐роЬро┐роЯрпНроЯро▓рпН',
                    'bank': 'ро╡роЩрпНроХро┐'
                }[contribution.paymentMethod] || contribution.paymentMethod;

                return `
                    <div class="contribution-item">
                        <div class="contribution-details">
                            <strong>${contribution.participantName}</strong>
                            <span class="contribution-amount">тВ╣${contribution.amount}</span>
                        </div>
                        <div class="contribution-meta">
                            <span class="payment-method">${paymentMethodText}</span>
                            <small>${new Date(contribution.date).toLocaleDateString('ta-IN')}</small>
                            ${event ? `<small> | ${event.name}</small>` : ''}
                        </div>
                        ${contribution.notes ? `<p><small>роХрпБро▒ро┐рокрпНрокрпБ: ${contribution.notes}</small></p>` : ''}
                    </div>
                `;
            }).join('');
        }

        // Report Generation
        function generateEventReport() {
            const eventId = document.getElementById('reportEvent').value;
            if (!eventId) {
                alert('роЕро▒ро┐роХрпНроХрпИропрпИ роЙро░рпБро╡ро╛роХрпНроХ ро╡ро┐ро┤ро╛ро╡рпИродрпН родрпЗро░рпНроирпНродрпЖроЯрпБроХрпНроХро╡рпБроорпН');
                return;
            }

            const event = events.find(e => e.id === eventId);
            const eventParticipants = participants.filter(p => p.eventId === eventId);
            const eventContributions = contributions.filter(c => c.eventId === eventId);
            const totalCollected = eventContributions.reduce((sum, c) => sum + c.amount, 0);
            const progressPercentage = event.targetAmount > 0 ? (totalCollected / event.targetAmount) * 100 : 0;

            const report = `
ро╡ро┐ро┤ро╛ роЕро▒ро┐роХрпНроХрпИ

ро╡ро┐ро┤ро╛ рокрпЖропро░рпН: ${event.name}
ро╡ро┐ро┤ро╛ ро╡роХрпИ: ${event.type}
родрпЗродро┐: ${event.date}
роЗроЯроорпН: ${event.location}
роЗро▓роХрпНроХрпБ родрпКроХрпИ: тВ╣${event.targetAmount}
родро┐ро░роЯрпНроЯрокрпНрокроЯрпНроЯ родрпКроХрпИ: тВ╣${totalCollected}
роорпБройрпНройрпЗро▒рпНро▒роорпН: ${progressPercentage.toFixed(1)}%

рокроЩрпНроХрпЗро▒рпНрокро╛ро│ро░рпНроХро│рпН (${eventParticipants.length}):
${eventParticipants.map(p => `- ${p.name} | ${p.phone} | ${p.email || '-'} | ${p.place || '-'}`).join('\n')}

рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│рпН (${eventContributions.length}):
${eventContributions.map(c => `- ${c.participantName} | тВ╣${c.amount} | ${c.paymentMethod} | ${new Date(c.date).toLocaleDateString()}`).join('\n')}

роЪрпБро░рпБроХрпНроХроорпН:
роорпКродрпНрод рокроЩрпНроХрпЗро▒рпНрокро╛ро│ро░рпНроХро│рпН: ${eventParticipants.length}
роорпКродрпНрод рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│рпН: ${eventContributions.length}
роорпКродрпНрод родро┐ро░роЯрпНроЯрокрпНрокроЯрпНроЯ родрпКроХрпИ: тВ╣${totalCollected}
роЗро▓роХрпНроХрпИ роЕроЯрпИро╡родрпБ: ${progressPercentage.toFixed(1)}%
            `;

            downloadTextFile(report, `${event.name}_роЕро▒ро┐роХрпНроХрпИ.txt`);
        }

        function generateParticipantList() {
            const eventId = document.getElementById('reportEvent').value;
            const eventParticipants = eventId ? 
                participants.filter(p => p.eventId === eventId) : 
                participants;

            if (eventParticipants.length === 0) {
                alert('рокродро┐ро╡ро┐ро▒роХрпНроХ рокроЩрпНроХрпЗро▒рпНрокро╛ро│ро░рпНроХро│рпН роЗро▓рпНро▓рпИ');
                return;
            }

            const event = events.find(e => e.id === eventId);
            const content = `
${event ? `${event.name} - рокроЩрпНроХрпЗро▒рпНрокро╛ро│ро░рпНроХро│рпН` : 'роЕройрпИродрпНродрпБ рокроЩрпНроХрпЗро▒рпНрокро╛ро│ро░рпНроХро│рпН'}

${eventParticipants.map(p => `- ${p.name} | ${p.phone} | ${p.email || '-'} | ${p.place || '-'}`).join('\n')}

роорпКродрпНрод рокроЩрпНроХрпЗро▒рпНрокро╛ро│ро░рпНроХро│рпН: ${eventParticipants.length}
            `;

            downloadTextFile(content, 'рокроЩрпНроХрпЗро▒рпНрокро╛ро│ро░рпНроХро│рпН_рокроЯрпНроЯро┐ропро▓рпН.txt');
        }

        function generateContributionReport() {
            const eventId = document.getElementById('reportEvent').value;
            const eventContributions = eventId ? 
                contributions.filter(c => c.eventId === eventId) : 
                contributions;

            if (eventContributions.length === 0) {
                alert('рокродро┐ро╡ро┐ро▒роХрпНроХ рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│рпН роЗро▓рпНро▓рпИ');
                return;
            }

            const totalAmount = eventContributions.reduce((sum, c) => sum + c.amount, 0);
            const event = events.find(e => e.id === eventId);

            const content = `
${event ? `${event.name} - рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│рпН` : 'роЕройрпИродрпНродрпБ рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│рпН'}

${eventContributions.map(c => `- ${c.participantName} | тВ╣${c.amount} | ${c.paymentMethod} | ${new Date(c.date).toLocaleDateString()}`).join('\n')}

роорпКродрпНрод рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│рпН: ${eventContributions.length}
роорпКродрпНрод родрпКроХрпИ: тВ╣${totalAmount}
            `;

            downloadTextFile(content, 'рокроЩрпНроХро│ро┐рокрпНрокрпБроХро│рпН_роЕро▒ро┐роХрпНроХрпИ.txt');
        }

        function updateProgress() {
            const eventProgress = document.getElementById('eventProgress');
            const eventId = document.getElementById('reportEvent').value;

            if (!eventId) {
                eventProgress.innerHTML = '<div class="empty-state"><p>роорпБройрпНройрпЗро▒рпНро▒родрпНродрпИроХрпН роХро╛рог ро╡ро┐ро┤ро╛ро╡рпИродрпН родрпЗро░рпНроирпНродрпЖроЯрпБроХрпНроХро╡рпБроорпН</p></div>';
                return;
            }

            const event = events.find(e => e.id === eventId);
            const eventContributions = contributions.filter(c => c.eventId === eventId);
            const totalCollected = eventContributions.reduce((sum, c) => sum + c.amount, 0);
            const progressPercentage = event.targetAmount > 0 ? (totalCollected / event.targetAmount) * 100 : 0;

            eventProgress.innerHTML = `
                <div class="progress-section">
                    <h3>${event.name} - родрпКроХрпБрокрпНрокрпБ роорпБройрпНройрпЗро▒рпНро▒роорпН</h3>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${progressPercentage}%"></div>
                    </div>
                    <p class="progress-text">
                        тВ╣${totalCollected} / тВ╣${event.targetAmount} (${progressPercentage.toFixed(1)}%)
                    </p>
                    <p class="progress-text">
                        <strong>родро┐ро░роЯрпНроЯрокрпНрокроЯрпНроЯродрпБ:</strong> тВ╣${totalCollected} | 
                        <strong>роорпАродроорпН:</strong> тВ╣${event.targetAmount - totalCollected}
                    </p>
                </div>
            `;
        }

        // Utility Functions
        function updateStats() {
            document.getElementById('totalEvents').textContent = events.length;
            document.getElementById('totalParticipants').textContent = participants.length;
            
            const totalAmount = contributions.reduce((sum, c) => sum + c.amount, 0);
            document.getElementById('totalAmount').textContent = `тВ╣${totalAmount}`;
        }

        function updateEventDropdowns() {
            const eventOptions = events.map(event => 
                `<option value="${event.id}">${event.name}</option>`
            ).join('');

            const eventSelects = ['participantEvent', 'contributionEvent', 'reportEvent'];
            eventSelects.forEach(selectId => {
                const select = document.getElementById(selectId);
                select.innerHTML = '<option value="">ро╡ро┐ро┤ро╛ро╡рпИродрпН родрпЗро░рпНроирпНродрпЖроЯрпБроХрпНроХро╡рпБроорпН</option>' + eventOptions;
                
                // Add onchange for report event to update progress
                if (selectId === 'reportEvent') {
                    select.onchange = updateProgress;
                }
            });

            updateParticipantDropdown();
        }

        function updateParticipantDropdown() {
            const eventId = document.getElementById('contributionEvent').value;
            const eventParticipants = eventId ? 
                participants.filter(p => p.eventId === eventId) : 
                [];

            const participantSelect = document.getElementById('contributionParticipant');
            participantSelect.innerHTML = '<option value="">рокроЩрпНроХрпЗро▒рпНрокро╛ро│ро░рпИродрпН родрпЗро░рпНроирпНродрпЖроЯрпБроХрпНроХро╡рпБроорпН</option>' +
                eventParticipants.map(p => 
                    `<option value="${p.id}">${p.name} (${p.phone})</option>`
                ).join('');
        }

        function selectEvent(eventId) {
            document.getElementById('reportEvent').value = eventId;
            showTab('reports');
            updateProgress();
        }

        function saveData() {
            localStorage.setItem('events', JSON.stringify(events));
            localStorage.setItem('participants', JSON.stringify(participants));
            localStorage.setItem('contributions', JSON.stringify(contributions));
        }

        function downloadTextFile(content, filename) {
            const blob = new Blob([content], { type: 'text/plain; charset=utf-8' });
            const url = window.URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = filename;
            link.click();
            window.URL.revokeObjectURL(url);
        }

        function showSuccess(message) {
            const successDiv = document.createElement('div');
            successDiv.className = 'success-message';
            successDiv.textContent = message;
            
            document.querySelector('.container').insertBefore(successDiv, document.querySelector('.container').firstChild);
            
            setTimeout(() => {
                successDiv.remove();
            }, 3000);
        }

        // Initialize the app when page loads
        window.onload = initApp;
    </script>
</body>
</html>
